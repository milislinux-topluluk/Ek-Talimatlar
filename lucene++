# Tanım: Popüler Java Lucene kitaplığının C ++ portu
# URL: https://github.com/luceneplusplus/LucenePlusPlus
# Paketçi: Cihan Alkan
# Gerekler: boost cmake
# Grup: deepin

isim=lucene++
surum=3.0.7
devir=1
kaynak=(https://github.com/luceneplusplus/LucenePlusPlus/archive/972c9cb37.tar.gz::$isim-$surum.tar.gz)

derle() {

  mkdir build
  #ln -s LucenePlusPlus-rel_$surum LucenePlusPlus-$surum
  #ln -s LucenePlusPlus-master LucenePlusPlus-$surum
  ln -s LucenePlusPlus-972c9cb37* LucenePlusPlus-$surum
  sed -i \
    -e 's#SET(LUCENE++_VERSION_REVISION.*#SET(LUCENE++_VERSION_REVISION "5")#' \
    -e 's#SET(LUCENE++_VERSION_PATCH.*#SET(LUCENE++_VERSION_PATCH "0")#' \
    "$SRC"/LucenePlusPlus-$surum/CMakeLists.txt

  cd build

  cmake ../LucenePlusPlus-$surum \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DLIB_DESTINATION=/usr/lib \
    -DBoost_LIBRARY_DIR=/usr/lib \
    -DENABLE_CUSTOM_ALLOCATOR='FALSE' \
    -DCMAKE_CXX_FLAGS='-DBOOST_VARIANT_USE_RELAXED_GET_BY_DEFAULT'
    # RELAXED for boost 1.58 breakage, remove when lucene++ updates

  make
  make DESTDIR="$PKG" install
}
